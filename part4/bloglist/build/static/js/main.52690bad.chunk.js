(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{43:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(17),i=n.n(c),s=n(2),o=n.n(s),u=n(5),l=n(3),d=n(0),j=function(e){var t=e.blog,n=e.handleIncreaseLike,a=e.handleDeletePost,c=Object(r.useState)(!1),i=Object(l.a)(c,2),s=i[0],o=i[1],u={paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},j=function(){o(!s)},b={display:s?"none":""},p={display:s?"":"none"};return Object(d.jsxs)("div",{children:[Object(d.jsxs)("div",{className:"visibleContent",style:Object.assign({},u,b),children:[Object(d.jsxs)("span",{children:["title: ",t.title]}),Object(d.jsx)("button",{className:"openButton",onClick:j,children:"Open"}),Object(d.jsxs)("p",{children:["author: ",t.author]})]}),Object(d.jsxs)("div",{className:"invisibleContent",style:Object.assign({},u,p),children:[Object(d.jsxs)("span",{children:["title: ",t.title]}),Object(d.jsx)("button",{onClick:j,children:"cancel"}),Object(d.jsxs)("p",{children:["author: ",t.author]}),Object(d.jsxs)("p",{children:["url: ",t.url]}),Object(d.jsxs)("span",{children:["likes: ",t.likes]}),Object(d.jsx)("button",{className:"likeButton",onClick:function(){n(t.id,{title:t.title,likes:t.likes+1})},children:"Like Post"}),Object(d.jsxs)("p",{children:["Owner: ",void 0===t.user.name?"No owner":t.user.name]}),Object(d.jsx)("button",{onClick:function(){window.confirm("are you sure you want to remove ".concat(t.title," by ").concat(t.author))&&a(t.id,t.title)},children:"Delete Post"})]})]})},b=function(e){var t=e.handleLogin,n=Object(r.useState)(""),a=Object(l.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)(""),o=Object(l.a)(s,2),u=o[0],j=o[1];return Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({username:c,password:u})},children:[Object(d.jsxs)("div",{children:["Username:",Object(d.jsx)("input",{type:"text",id:"username",value:c,name:"Username",onChange:function(e){var t=e.target;return i(t.value)}})]}),Object(d.jsxs)("div",{children:["Password:",Object(d.jsx)("input",{type:"text",id:"password",value:u,name:"Password",onChange:function(e){var t=e.target;return j(t.value)}})]}),Object(d.jsx)("button",{id:"login-button",type:"submit",children:"login"})]})},p=function(e){var t=e.handleCreateBlog,n=Object(r.useState)(""),a=Object(l.a)(n,2),c=a[0],i=a[1],s=Object(r.useState)(""),o=Object(l.a)(s,2),u=o[0],j=o[1],b=Object(r.useState)(""),p=Object(l.a)(b,2),h=p[0],f=p[1];return Object(d.jsx)("div",{children:Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:c,author:u,url:h}),i(""),j(""),f("")},children:[Object(d.jsxs)("div",{children:["Title:",Object(d.jsx)("input",{type:"text",id:"title",value:c,name:"title",onChange:function(e){var t=e.target;return i(t.value)}})]}),Object(d.jsxs)("div",{children:["Author:",Object(d.jsx)("input",{id:"author",type:"text",value:u,name:"author",onChange:function(e){var t=e.target;return j(t.value)}})]}),Object(d.jsxs)("div",{children:["Url:",Object(d.jsx)("input",{id:"url",type:"text",value:h,name:"url",onChange:function(e){var t=e.target;return f(t.value)}})]}),Object(d.jsx)("button",{type:"submit",children:"create"})]})})},h=a.a.forwardRef((function(e,t){var n=Object(r.useState)(!1),a=Object(l.a)(n,2),c=a[0],i=a[1],s={display:c?"none":""},o={display:c?"":"none"},u=function(){i(!c)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:u}})),Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{style:s,children:Object(d.jsx)("button",{onClick:u,children:e.buttonLabel})}),Object(d.jsxs)("div",{style:o,children:[e.children,Object(d.jsx)("button",{onClick:u,children:"cancel"})]})]})}));h.displayName="Togglable";var f=h,O=function(e){var t=e.error;return Object(d.jsx)("div",{className:"error",children:Object(d.jsx)("p",{children:t})})},v=n(6),x=n.n(v),g="/api/blog",m=null,w=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get(g);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:m}},e.next=3,x.a.post(g,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(u.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:m}},e.next=3,x.a.put("".concat(g,"/").concat(t),n,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),S=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:m}},e.next=3,x.a.delete("".concat(g,"/").concat(t),n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C={setToken:function(e){m="bearer ".concat(e)},getAll:w,create:k,update:y,deletePost:S},T=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N={login:T},A=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),i=Object(l.a)(c,2),s=i[0],h=i[1],v=Object(r.useState)(""),x=Object(l.a)(v,2),g=x[0],m=x[1],w=Object(r.useRef)();Object(r.useEffect)((function(){C.getAll().then((function(e){return a(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedUser"),t=JSON.parse(window.localStorage.getItem("authentication"));if(e&&t.end>=Date.now()){var n=JSON.parse(e);h(n),C.setToken(n.token)}}),[]);var k=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.password,e.prev=1,e.next=4,N.login({username:n,password:r});case 4:a=e.sent,c={start:Date.now(),end:Date.now()+36e5},h(a),C.setToken(a.token),window.localStorage.setItem("loggedUser",JSON.stringify(a)),window.localStorage.setItem("authentication",JSON.stringify(c)),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),m("Wrong Credentials"),setTimeout((function(){m(null)}),5e3);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r,c,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.title,r=t.author,c=t.url,w.current.toggleVisibility(),e.prev=2,e.next=5,C.create({title:n,author:r,url:c});case 5:i=e.sent,C.getAll().then((function(e){return a(e)})),m("".concat(i.title," created with success")),setTimeout((function(){m(null)}),5e3),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),m("Invalid parameters for creating a blog"),setTimeout((function(){m(null)}),5e3);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(u.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.update(t,n);case 3:C.getAll().then((function(e){return a(e)})),m("".concat(n.title," likes updated to ").concat(n.likes)),setTimeout((function(){m(null)}),5e3),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),m("Can't update this post"),setTimeout((function(){m(null)}),5e3);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),T=function(){var e=Object(u.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.deletePost(t);case 3:return e.next=5,C.getAll();case 5:r=e.sent,a(r),m("".concat(n," deleted by ").concat(s.name)),setTimeout((function(){m(null)}),5e3),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0),m("You can't delete this post"),setTimeout((function(){m(null)}),5e3);case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"blogs"}),Object(d.jsx)(O,{error:g}),null===s?Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"Log in to application"}),Object(d.jsx)(O,{error:g}),Object(d.jsx)(f,{buttonLabel:"login",children:Object(d.jsx)(b,{handleLogin:k})})]}):Object(d.jsxs)("div",{children:[s.name," logged in",Object(d.jsx)("button",{onClick:function(){window.localStorage.clear(),C.setToken(null),h(null)},children:"logout"}),Object(d.jsx)(f,{buttonLabel:"Add new blog",ref:w,children:Object(d.jsx)(p,{handleCreateBlog:y})})]}),n.sort((function(e,t){return e.likes>t.likes?-1:1})).map((function(e){return Object(d.jsx)(j,{blog:e,handleIncreaseLike:S,handleDeletePost:T},e.id)}))]})};i.a.render(Object(d.jsx)(A,{}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.52690bad.chunk.js.map